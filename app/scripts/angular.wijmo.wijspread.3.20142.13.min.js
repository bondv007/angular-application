/*
 *
 * SpreadJS Library 3.20142.13
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 **/
var m=angular.module("wijspread",[]);(function(){function f(n){var t,i;return n?(n=n.trim(),t=n.indexOf(",")>=0?n.split(","):n.split(" "),i=new $.wijmo.wijspread.LineBorder,i.color=t[0].trim(),t.length>1&&(i.style=$.wijmo.wijspread.LineStyle[t[1].trim()]),i):undefined}function i(n,t,i){if(n&&t){t=t.toLowerCase();var r;t==="numbervalidator"?r=$.wijmo.wijspread.DefaultDataValidator.createNumberValidator(i.comparisonOperator,i.value1,i.value2,i.isIntegervalue):t==="datevalidator"?r=$.wijmo.wijspread.DefaultDataValidator.createDateValidator(i.comparisonOperator,i.value1,i.value2):t==="textlengthvalidator"?r=$.wijmo.wijspread.DefaultDataValidator.createTextLengthValidator(i.comparisonOperator,i.value1,i.value2):t==="formulavalidator"?r=$.wijmo.wijspread.DefaultDataValidator.createFormulaValidator(i.formula):t==="formulalistvalidator"?r=$.wijmo.wijspread.DefaultDataValidator.createFormulaListValidator(i.formulaList):t==="listvalidator"&&(r=$.wijmo.wijspread.DefaultDataValidator.createListValidator(i.list));r&&(i.ignoreBlank!==undefined&&(r.ignoreBlank=i.ignoreBlank),i.inCellDropdown!==undefined&&(r.inCellDropdown=i.inCellDropdown),i.showInputMessage!==undefined&&(r.showInputMessage=i.showInputMessage),i.showErrorMessage!==undefined&&(r.showErrorMessage=i.showErrorMessage),i.errorStyle!==undefined&&(r.errorStyle=i.errorStyle),i.inputMessage!==undefined&&(r.inputMessage=i.inputMessage),i.inputTitle!==undefined&&(r.inputTitle=i.inputTitle),i.errorMessage!==undefined&&(r.errorMessage=i.errorMessage),i.errorTitle!==undefined&&(r.errorTitle=i.errorTitle),n.validator=r)}}function l(n,t,i){n._angularDataValidationResult=i}function a(n,t,i){if(i.text!==undefined||i.value!==undefined){i.text===undefined?i.text=i.value:i.value===undefined&&(i.value=i.text);var r;n.items()?r=n.items():(r=[],n.items(r));r.push(i)}}function o(n,t,i){t&&i.groups&&(t=t.toLowerCase().trim(),angular.forEach(i.groups,function(i){t==="rowrangegroup"?n.rowRangeGroup.group(i.index,i.count):n.colRangeGroup.group(i.index,i.count)}))}function v(n,t,i){n.groups||(n.groups=[]);n.groups.push(i)}function y(n,t){return n[t].call(n).name()}function c(n){this.headerText="";this.dataField="";this.index=n}for(var n,u,r={backcolor:{type:"string",name:"backColor"},forecolor:{type:"string",name:"foreColor"},halign:{type:"enum, HorizontalAlign",name:"hAlign"},valign:{type:"enum, VerticalAlign",name:"vAlign"},font:{type:"string",name:"font"},themefont:{type:"string",name:"themeFont"},formatter:{type:"string",name:"formatter"},border:{type:"LineBordeer",name:"border",getProperties:["borderLeft","borderTop","borderRight","borderBottom"],setProperties:["borderLeft","borderTop","borderRight","borderBottom"],converter:f},borderleft:{type:"LineBorder",name:"borderLeft",converter:f},bordertop:{type:"LineBorder",name:"borderTop",converter:f},borderright:{type:"LineBorder",name:"borderRight",converter:f},borderbottom:{type:"LineBorder",name:"borderBottom",converter:f},locked:{type:"boolean",name:"locked"},wordwrap:{type:"boolean",name:"wordWrap"},textindent:{type:"number",name:"textIndent"},shrinktofit:{type:"boolean",name:"shrinkToFit"},backgroundimage:{type:"string",name:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout"},numbervalidator:{type:"object",name:"numberValidator",setFunction:i,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"},isintegervalue:{type:"boolean",name:"isIntegerValue"}}},datevalidator:{type:"object",name:"dateValidator",setFunction:i,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},textlengthvalidator:{type:"object",name:"textLengthValidator",setFunction:i,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},formulavalidator:{type:"object",name:"formulaValidator",setFunction:i,properties:{formula:{type:"string",name:"formula"}}},formulalistvalidator:{type:"object",name:"formulaListValidator",setFunction:i,properties:{formulalist:{type:"string",name:"formulaList"}}},listvalidator:{type:"object",name:"listValidator",setFunction:i,properties:{list:{type:"string",name:"list"}}},textcelltype:{type:"TextCellType",name:"cellType",properties:{}},buttoncelltype:{type:"ButtonCellType",name:"cellType",properties:{buttonbackcolor:{type:"string",name:"buttonBackColor",setFunction:"buttonBackColor"},marginleft:{type:"number",name:"marginLeft",setFunction:"marginLeft"},margintop:{type:"number",name:"marginTop",setFunction:"marginTop"},marginright:{type:"number",name:"marginRight",setFunction:"marginRight"},marginbottom:{type:"number",name:"marginBottom",setFunction:"marginBottom"},text:{type:"string",name:"text",setFunction:"text"}}},checkboxcelltype:{type:"CheckBoxCellType",name:"cellType",properties:{caption:{type:"string",name:"caption",setFunction:"caption"},isthreestate:{type:"boolean",name:"isThreeState",setFunction:"isThreeState"},textalign:{type:"enum,CheckBoxTextAlign",name:"textAlign",setFunction:"textAlign"},textfalse:{type:"string",name:"textFalse",setFunction:"textFalse"},textindeterminate:{type:"string",name:"textIndeterminate",setFunction:"textIndeterminate"},texttrue:{type:"string",name:"textTrue",setFunction:"textTrue"}}},comboboxcelltype:{type:"ComboBoxCellType",name:"cellType",properties:{editorvaluetype:{type:"enum,EditorValueType",name:"editorValueType",setFunction:"editorValueType"},item:{type:"object",name:"items",setFunction:a,properties:{value:{type:"string",name:"value"},text:{type:"string",name:"text"}}}}},hyperlinkcelltype:{type:"HyperLinkCellType",name:"cellType",properties:{linkcolor:{type:"string",name:"linkColor",setFunction:"linkColor"},linktooltip:{type:"string",name:"linkToolTip",setFunction:"linkToolTip"},text:{type:"string",name:"text",setFunction:"text"},visitedlinkcolor:{type:"string",name:"visitedLinkColor",setFunction:"visitedLinkColor"}}}},s=["numbervalidator","datevalidator","textlengthvalidator","formulavalidator","formulalistvalidator","listvalidator"],e=0;e<s.length;e++)n=r[s[e]].properties,n.ignoreblank={type:"boolean",name:"ignoreBlank"},n.incelldropdown={type:"boolean",name:"inCellDropdown"},n.showinputmessage={type:"boolean",name:"showInputMessage"},n.showerrormessage={type:"boolean",name:"showErrorMessage"},n.errorstyle={type:"enum, ErrorStyle",name:"errorStyle"},n.inputmessage={type:"string",name:"inputMessage"},n.inputtitle={type:"string",name:"inputTitle"},n.errormessage={type:"string",name:"errorMessage"},n.errortitle={type:"string",name:"errorTitle"};var h={group:{type:"object",name:"group",setFunction:v,properties:{index:{type:"number",name:"index"},count:{type:"number",name:"count"}}}},p={name:{type:"string",name:"name"},usewijmotheme:{type:"boolean",name:"useWijmoTheme"},allowuserzoom:{type:"boolean",name:"allowUserZoom",setFunction:"allowUserZoom",getFunction:"allowUserZoom"},allowuserresize:{type:"boolean",name:"allowUserResize",setFunction:"allowUserResize",getFunction:"allowUserResize"},tabstripvisible:{type:"boolean",name:"tabStripVisible",setFunction:"tabStripVisible",getFunction:"tabStripVisible"},tabeditable:{type:"boolean",name:"tabEditable",setFunction:"tabEditable",getFunction:"tabEditable"},newtabvisible:{type:"boolean",name:"newTabVisible",setFunction:"newTabVisible",getFunction:"newTabVisible"},canusereditformula:{type:"boolean",name:"canUserEditFormula",setFunction:"canUserEditFormula",getFunction:"canUserEditFormula"},autofittype:{type:"enum, AutoFitType",name:"autoFitType",setFunction:"autoFitType",getFunction:"autoFitType"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},highlightinvaliddata:{type:"boolean",name:"highlightInvalidData",setFunction:"highlightInvalidData",getFunction:"highlightInvalidData"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},backcolor:{type:"string",name:"backColor",setFunction:"backColor",getFunction:"backColor"},grayareabackcolor:{type:"string",name:"grayAreaBackColor",setFunction:"grayAreaBackColor",getFunction:"grayAreaBackColor"},backgroundimage:{type:"string",name:"backgroundImage",setFunction:"backgroundImage",getFunction:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout",setFunction:"backgroundImageLayout",getFunction:"backgroundImageLayout"},showverticalscrollbar:{type:"boolean",name:"showVerticalScrollbar",setFunction:"showVerticalScrollbar",getFunction:"showVerticalScrollbar"},showhorizontalscrollbar:{type:"boolean",name:"showHorizontalScrollbar",setFunction:"showHorizontalScrollbar",getFunction:"showHorizontalScrollbar"},showscrolltip:{type:"enum, ShowScrollTip",name:"showScrollTip",setFunction:"showScrollTip",getFunction:"showScrollTip"},showresizetip:{type:"enum, ShowResizeTip",name:"showResizeTip",setFunction:"showResizeTip",getFunction:"showResizeTip"},showdragdroptip:{type:"boolean",name:"showDragDropTip",setFunction:"showDragDropTip",getFunction:"showDragDropTip"},showdragfilltip:{type:"boolean",name:"showDragFillTip",setFunction:"showDragFillTip",getFunction:"showDragFillTip"},datavalidationresult:{type:"enum, DataValidationResult",name:"DataValidationResult",setFunction:l}},w={name:{type:"string",name:"name",setFunction:"setName",getFunction:"getName"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},frozentrailingcolumncount:{type:"number",name:"frozenTrailingColumnCount",setFunction:"setFrozenTrailingColumnCount",getFunction:"getFrozenTrailingColumnCount"},frozentrailingrowcount:{type:"number",name:"frozenTrailingRowCount",setFunction:"setFrozenTrailingRowCount",getFunction:"getFrozenTrailingRowCount"},frozencolumncount:{type:"number",name:"frozenColumnCount",setFunction:"setFrozenColumnCount",getFunction:"getFrozenColumnCount"},frozenrowcount:{type:"number",name:"frozenRowCount",setFunction:"setFrozenRowCount",getFunction:"getFrozenRowCount"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",$.wijmo.wijspread.SheetArea.viewport]},properties:r},rowheaderdefaultstyle:{type:"Style",name:"rowHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",$.wijmo.wijspread.SheetArea.rowHeader]},properties:r},columnheaderdefaultstyle:{type:"Style",name:"columnHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",$.wijmo.wijspread.SheetArea.colHeader]},properties:r},cornerheaderdefaultstyle:{type:"Style",name:"cornerHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",$.wijmo.wijspread.SheetArea.corner]},properties:r},allowcelloverflow:{type:"boolean",name:"allowCellOverflow",setFunction:"allowCellOverflow",getFunction:"allowCellOverflow"},frozenlinecolor:{type:"string",name:"frozenlineColor",setFunction:"frozenlineColor",getFunction:"frozenlineColor"},sheettabcolor:{type:"string",name:"sheetTabColor",setFunction:"sheetTabColor",getFunction:"sheetTabColor"},rowcount:{type:"number",name:"rowCount",setFunction:"setRowCount",getFunction:"getRowCount"},selectionpolicy:{type:"enum, SelectionPolicy",name:"selectionPolicy",setFunction:"selectionPolicy",getFunction:"selectionPolicy"},selectionunit:{type:"enum,SelectionUnit",name:"selectionUnit",setFunction:"selectionUnit",getFunction:"selectionUnit"},zoom:{type:"number",name:"zoom",setFunction:"zoom",getFunction:"zoom"},currenttheme:{type:"string",name:"currentTheme",setFunction:"currentTheme",getFunction:y},clipboardoptions:{type:"enum,ClipboardPasteOptions",name:"clipBoardOptions",setFunction:"clipBoardOptions",getFunction:"clipBoardOptions"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},rowheadervisible:{type:"boolean",name:"rowHeaderVisible",setFunction:"setRowHeaderVisible",getFunction:"getRowHeaderVisible"},columnheadervisible:{type:"boolean",name:"columnHeaderVisible",setFunction:"setColumnHeaderVisible",getFunction:"getColumnHeaderVisible"},rowheaderautotext:{type:"enum, HeaderAutoText",name:"rowHeaderAutoText",setFunction:"setRowHeaderAutoText",getFunction:"getRowHeaderAutoText"},columnheaderautotext:{type:"enum, HeaderAutoText",name:"columnHeaderAutoText",setFunction:"setColumnHeaderAutoText",getFunction:"getColumnHeaderAutoText"},rowheaderautotextindex:{type:"number",name:"rowHeaderAutoTextIndex",setFunction:"setRowHeaderAutoTextIndex",getFunction:"getRowHeaderAutoTextIndex"},columnheaderautotextindex:{type:"number",name:"columnHeaderAutoTextIndex",setFunction:"setColumnHeaderAutoTextIndex",getFunction:"getColumnHeaderAutoTextIndex"},isprotected:{type:"boolean",name:"isProtected",setFunction:"setIsProtected",getFunction:"getIsProtected"},showrowrangegroup:{type:"boolean",name:"showRowRangeGroup",setFunction:"showRowRangeGroup",getFunction:"showRowRangeGroup"},showcolumnrangegroup:{type:"boolean",name:"showColumnRangeGroup",setFunction:"showColumnRangeGroup",getFunction:"showColumnRangeGroup"},rowrangegroup:{type:"object",name:"rowRangeGroup",setFunction:o,properties:h},colrangegroup:{type:"object",name:"colRangeGroup",setFunction:o,properties:h},selectionbackcolor:{type:"string",name:"selectionBackColor",setFunction:"selectionBackColor",getFunction:"selectionBackColor"},selectionbordercolor:{type:"string",name:"selectionBorderColor",setFunction:"selectionBorderColor",getFunction:"selectionBorderColor"},datasourcedeepwatch:{type:"boolean",name:"dataSourceDeepWatch"}},b={datafield:{type:"string",name:"dataField"},headertext:{type:"string",name:"headerText"},width:{type:"number",name:"width",setFunction:"width",getFunction:"width"},visible:{type:"boolean",name:"visible",setFunction:"visible",getFunction:"visible"},resizable:{type:"boolean",name:"resizable",setFunction:"resizable",getFunction:"resizable"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:"defaultStyle",getFunction:"defaultStyle",properties:r}},t;(function(n){n._map=[];n.ELEMENT_NODE=1;n.ATTRIBUTE_NODE=2;n.TEXT_NODE=3;n.CDATA_SECTION_NODE=4;n.ENTITY_REFERENCE_NODE=5;n.ENTITY_NODE=6;n.PROCESSING_INSTRUCTION_NODE=7;n.COMMENT_NODE=8;n.DOCUMENT_NODE=9;n.DOCUMENT_TYPE_NODE=10;n.DOCUMENT_FRAGMENT_NODE=11;n.NOTATION_NODE=12})(t||(t={})),function(n){var i=n;n.setValuesAndBindings=function(t){i.valueCatch&&angular.forEach(i.valueCatch,function(n){var t=n.target;angular.forEach(n.setting,function(n){var r=n.nodeDef,u=n.value;i.setPropertyValue(t,r,u)})});var r=t.$parent;i.bindings&&angular.forEach(i.bindings,function(t){var u,f;t.dynamicText&&(u=t.dynamicText.substring(2,t.dynamicText.length-2),t.target.bindingPath=u,t.target.parentScope=r,f=u,r[f]===undefined?r[f]=n.getPropertyValue(t.target,t.metadata):i.setPropertyValue(t.target,t.metadata,r[f]),r.$watch(u,function(n){i.setPropertyValue(t.target,t.metadata,n)}))})};n.initSpread=function(n,t,r){var u=t[0];i._readNodeWithChildren(n,u,p,"sheets",!1)};n.initSheet=function(n,t,r){var u=t[0];i._readNodeWithChildren(n,u,w,"columns",!1)};n.initColumn=function(n,t,r){var u=t[0];i._readNodeWithChildren(n,u,b,undefined,!1)};n._readNodeWithChildren=function(n,t,r,u,f){if(!f){i.valueCatch||(i.valueCatch=[]);var e;angular.forEach(i.valueCatch,function(t){t.target===n&&(e=t)});e||(e={target:n,setting:[]},i.valueCatch.push(e))}angular.forEach(t.attributes,function(t){i._readNode(n,t,r,e,f)});t.childNodes.length>0&&angular.forEach(t.childNodes,function(t){var h=t.nodeName.toLowerCase(),o,s,c;if((h=i.normalizeName(h),!u||h!==u)&&(o=r[h],o&&o.type)){if(o.type==="object")s={};else{if(c=$.wijmo.wijspread[o.type],!c)return;s=new c}i._readNodeWithChildren(s,t,o.properties,undefined,!0);f?i.setPropertyValue(n,o,s):e.setting.push({nodeDef:o,value:s})}})};n.convertValue=function(n,t,r){var h,o,u,e,s,f;if(r)return r.call(null,n);if(n===undefined||t===undefined)return n;if(typeof n=="string"&&(n=n.trim()),t.length>2&&t[0]==="["&&(h=t.substring(1,t.length-2),n.length>2)){for(n[0]==="["&&n[n.length-1]==="]"&&(n=n.substring(1,n.length-2)),o=n.split(","),u=[],f=0;f<o.length;f++)u.push(i.convertValue(o[f],h,r));return u}switch(t){case"string":return n;case"boolean":if(typeof n=="boolean")return n;if(n.toLowerCase()==="true")return!0;else if(n.toLowerCase()==="false")return!1;return Boolean(n);case"number":return Number(n);case"color":return n}if(t.length>5&&t.substring(0,5)==="enum,"){if(typeof n!="number"&&(typeof n!="string"||parseInt(n)===undefined||isNaN(parseInt(n)))){if(t=t.substring(5).trim(),e=$.wijmo.wijspread,t.indexOf(".")>0)for(s=name.split("."),f=0;f<s.length;f++)e=u[s[f]];else e=e[t];u=e[n];u===undefined&&(n=n[0].toUpperCase()+n.substring(1),u=e[n])}else u=parseInt(n);return u}return n};n.normalizeName=function(n){if(n.match(/-/)){var t=n.split("-");n=t.shift();angular.forEach(t,function(t){n+=t})}return n};n._readNode=function(n,r,u,f,e){var c=$(r),o,s,l,h;switch(r.nodeType){case t.ATTRIBUTE_NODE:o=c.val();break;case t.ELEMENT_NODE:o=c.text();break;default:return}if(s=r.nodeName||r.name,s=s.toLowerCase(),s=i.normalizeName(s),h=u[s],h)s=h.name;else return;if(!i.hasChildElements(r)&&o&&o.length>4&&o.substring(0,2)==="{{"&&o.substring(o.length-2)==="}}"){i.bindings||(i.bindings=[]);i.bindings.push({target:n,metadata:h,path:s,dynamicText:o});return}o.match(/^[^\d]/)&&r.nodeType===t.ATTRIBUTE_NODE&&(h.changeEvent||h.twoWayBinding)?(i.bindings||(i.bindings=[]),_ngMgr.bindings.push({path:(path&&path+".")+s,expression:o})):r.nodeType===t.ATTRIBUTE_NODE&&(e||s==="dataSourceDeepWatch"?i.setPropertyValue(n,h,o):f.setting.push({nodeDef:h,value:o}))};n.setPropertyValue=function(n,t,r){if(r!==undefined){n.$scopeObject&&(n=n.$scopeObject);try{r=i.convertValue(r,t.type,t.converter);t.setProperties?angular.forEach(t.setProperties,function(t){i.setPropertyValueCore(n,r,t)}):t.setFunction?typeof t.setFunction=="function"?t.setFunction.call(i,n,t.name,r):i.setPropertyValueCore(n,r,undefined,t.setFunction):(i.setPropertyValueCore(n,r,t.name),n[t.name]=r)}catch(u){}}};n.setPropertyValueCore=function(n,t,i,r){var f,u,e;if(i)n[i]=t;else if(r)if(typeof r=="string")n[r].call(n,t);else{for(f=r.name,u=[],e=0;e<r.args.length;e++)u[e]=r.args[e]==="$value-replace$"?t:r.args[e];switch(u.length){case 1:n[f].call(n,u[0]);break;case 2:n[f].call(n,u[0],u[1]);break;case 3:n[f].call(n,u[0],u[1],u[2]);break;case 4:n[f].call(n,u[0],u[1],u[2],u[3]);break;case 5:n[f].call(n,u[0],u[1],u[2],u[3],u[4]);break}}};n.getPropertyValue=function(n,t){n.$scopeObject&&(n=n.$scopeObject);var r="";try{if(t.getProperties)angular.forEach(t.getProperties,function(t){r=r===""?i.setPropertyValueCore(n,r,t):r+","+i.setPropertyValueCore(n,r,t)});else if(t.getFunction)if(typeof t.getFunction=="function")return t.getFunction.call(i,n,t.name);else r=i.getPropertyValueCore(n,undefined,t.getFunction);else r=i.getPropertyValueCore(n,name)}catch(u){}return r};n.getPropertyValueCore=function(n,t,i){if(t)return n[t];else if(i&&typeof i=="string")return n[i].call(n);return""};n.hasChildElements=function(n){var r,i,u;if(!n||!n.childNodes)return!1;for(r=n.childNodes.length,i=0;i<r;i++)if(u=n.childNodes[i],u.nodeType==t.ELEMENT_NODE)return!0;return!1}}(u||(u={}));m.directive("wijSpread",function(){return{restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",scope:{},controller:["$scope",function(n){n.sheets=[];this.addSheet=function(t){n.sheets.push(t)}}],link:function(n,t,i){var e,f,r,o;for(u.initSpread(n,t,i),r=0;r<n.sheets.length;r++)u.initSheet(n.sheets[r].sheet,n.sheets[r].element,n.sheets[r].attrs),n.sheets[r].sheet.initColumns();for(e=n.sheets?n.sheets.length:1,t.wijspread({sheetCount:e}),f=t.wijspread("spread"),n.$scopeObject=f,r=0;r<n.sheets.length;r++)o=f.getSheet(r),n.sheets[r].sheet.setSheet(f,o);u.setValuesAndBindings(n)}}});m.directive("sheets",function(){return{require:"^wijSpread",restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",link:function(n,t,i,r){angular.forEach(n.sheets,function(n){r.addSheet(n)})},controller:["$scope",function(n){n.sheets=[];this.addSheet=function(t,i,r){n.sheets.push({sheet:t,element:i,attrs:r})}}]}});m.directive("sheet",function(){return{require:"^sheets",restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",scope:{datasource:"=",autoFit:"@"},controller:["$scope",function(n){n.columns=[];this.addColumn=function(t){return n.columns.push(t),n.columns.length-1};this.updataBinding=function(t,i){var r=n.columnWrappers[t];r.dataField=i};n.initColumns=function(){var t,i;for(n.columnWrappers=[],t=0;t<n.columns.length;t++)i=new c(t),u.initColumn(i,n.columns[t].element,n.columns[t].attrs),n.columnWrappers.push(i)}}],link:function(n,t,i,r){var u=$.wijmo.wijspread;r.addSheet(n,t,i);n.setSheet=function(t,i){function e(n,t){o(n,t)}function o(t,r){var o,a,f,e;if(n.datasource)if(n.datasource!==i.getDataSource()){if(i.isPaintSuspended(!0),o=n.columns&&n.columns.length>0,o)for(i.autoGenerateColumns=!1,i.setDataSource(n.datasource,!1),i.setColumnCount(n.columns.length),f=0;f<n.columns.length;f++)s(f);else{for(a=c(),i.autoGenerateColumns=!0,i.setDataSource(n.datasource,!1),f=0;f<i.getColumnCount();f++)e=i.getValue(0,f,u.SheetArea.colHeader),e=h(e),i.setValue(0,f,e,u.SheetArea.colHeader),e.indexOf("$$")==0&&(i.deleteColumns(f,1),f--);l(a)}i.isPaintSuspended(!1)}else t&&r&&t.length!=r.length?(i.setRowCount(t.length),i.invalidateLayout(),i.repaint()):(i.invalidateLayout(),i.repaint());else i.invalidateLayout(),i.repaint()}function s(t){var u=i.getColumn(t),r=n.columnWrappers[t],f=n.columns[t];(r.dataField||r.headerText)&&i.bindColumn(t,{name:r.dataField,displayName:r.headerText});r._width!==undefined&&u.width(r._width);r._visible!==undefined&&u.visible(r._visible);r._resizable!==undefined&&u.resizable(r._resizable);n.columns[t].autofit&&i.autoFitColumn(t)}function h(n){for(n=n.charAt(0).toUpperCase()+n.slice(1);n.indexOf("_")>-1;)n=n.replace("_"," ");return n}function c(){for(var t=[],n=0;n<i.getColumnCount();n++)t.push(i.getColumn(n).width());return t}function l(n){if(i.getColumnCount()==n.length)for(var t=0;t<i.getColumnCount();t++)i.getColumn(t).width(n[t])}var f,r;n.$scopeObject=i;f=n.columns&&n.columns.length>0;f&&(i.setColumnCount(n.columns.length),angular.forEach(n.columnWrappers,function(n){n.sheet=i;n.column=i.getColumn(n.index)}));r=!0;n.dataSourceDeepWatch!==undefined&&(r=n.dataSourceDeepWatch);n.$watch("datasource",e,r);i.bind(u.Events.ValidationError,function(n,i){i.validationResult=t._angularDataValidationResult!==undefined?t._angularDataValidationResult:u.DataValidationResult.Discard});i.bind(u.Events.ColumnWidthChanged,function(t,i){for(var r,o=i.sheet,e=i.colList,u,f=0;f<e.length;f++)r=n.columnWrappers[e[f]],r.parentScope&&r.bindingPath&&(u=r.parentScope,u[r.bindingPath]=o.getColumnWidth(e[f]));u&&u.$apply()});i.bind(u.Events.SheetNameChanged,function(t,i){n.parentScope&&n.bindingPath&&(n.parentScope[n.bindingPath]=i.newValue,n.parentScope.$apply())});i.bind(u.Events.UserZooming,function(t,i){n.parentScope&&n.bindingPath&&(n.parentScope[n.bindingPath]=i.newZoomFactor,n.parentScope.$apply())})}}}});m.directive("columns",function(){return{require:"^sheet",restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",link:function(n,t,i,r){n.sheet=r;angular.forEach(n.columns,function(n){r.addColumn(n)})},controller:["$scope",function(n){n.columns=[];this.addColumn=function(t){n.columns.push(t)};this.indexOf=function(t){return n.columns.indexOf(t)};this.updataBinding=function(t,i){n.sheet.updataBinding(this.indexOf(t),i)}}]}});c.prototype={width:function(n){return arguments.length===0?this.column.width():(this._width=n,this.column.width(n),this)},visible:function(n){return arguments.length===0?this.column.visible():(this._visible=n,this.column.visible(n),this)},resizable:function(n){return arguments.length===0?this.column.resizable():(this._resizable=n,this.column.resizable(n),this)},defaultStyle:function(n){return arguments.length===0?this.sheet.getStyle(-1,this.index,$.wijmo.wijspread.SheetArea.viewport):(this._defaultStyle=n,this.sheet.setStyle(-1,this.index,n,$.wijmo.wijspread.SheetArea.viewport),this)}};m.directive("column",function(){return{require:"^columns",restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",scope:{datafield:"@",autofit:"@"},controller:["$scope",function(n){n.items={title:n.header,wdth:n.width}}],link:function(n,t,i,r){r.addColumn(n);n.element=t;n.attrs=i;n.$watch("datafield",function(t){r.updataBinding(n,t)})}}})})()
